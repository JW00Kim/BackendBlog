# 2025-12-25 ëŒ“ê¸€ ì¢‹ì•„ìš” ê¸°ëŠ¥ êµ¬í˜„ ë…¸íŠ¸

## 1. ë°±ì—”ë“œ: ëŒ“ê¸€ ì¢‹ì•„ìš” API ì¶”ê°€

**ìœ„ì¹˜:** backend/routes/comments.js

### ì¶”ê°€ëœ ì½”ë“œ
```js
// @route   POST /api/comments/:id/like
// @desc    ëŒ“ê¸€ ì¢‹ì•„ìš”/ì·¨ì†Œ
// @access  Private
router.post("/comments/:id/like", authenticate, async (req, res) => {
  try {
    const { id } = req.params;
    const userId = req.user._id;
    const comment = await Comment.findById(id);
    if (!comment) {
      return res.status(404).json({ success: false, message: "ëŒ“ê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" });
    }
    // ì´ë¯¸ ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ëŠ”ì§€ í™•ì¸
    const isLiked = comment.likes.includes(userId);
    if (isLiked) {
      comment.likes.pull(userId); // ì¢‹ì•„ìš” ì·¨ì†Œ
    } else {
      comment.likes.push(userId); // ì¢‹ì•„ìš” ì¶”ê°€
    }
    await comment.save();
    res.json({
      success: true,
      message: isLiked ? "ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤" : "ëŒ“ê¸€ì— ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ìŠµë‹ˆë‹¤",
      data: { likesCount: comment.likes.length, isLiked: !isLiked }
    });
  } catch (error) {
    res.status(500).json({ success: false, message: "ì„œë²„ ì˜¤ë¥˜", error: error.message });
  }
});
```

#### ì„¤ëª…
- ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ê°€ëŠ¥ (`authenticate` ë¯¸ë“¤ì›¨ì–´)
- ì´ë¯¸ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ê²½ìš° ë‹¤ì‹œ ëˆ„ë¥´ë©´ ì·¨ì†Œ(í† ê¸€)
- ì‘ë‹µì— ì¢‹ì•„ìš” ê°œìˆ˜(`likesCount`)ì™€ ìƒíƒœ(`isLiked`) ë°˜í™˜

---

## 2. í”„ë¡ íŠ¸ì—”ë“œ: ëŒ“ê¸€ ì¢‹ì•„ìš” UI/ë¡œì§ ì¶”ê°€

**ìœ„ì¹˜:** frontend/src/components/PostDetail.jsx

### ì£¼ìš” ì¶”ê°€/ìˆ˜ì • ì½”ë“œ
```jsx
import { likeComment } from "../api";
// ...ê¸°ì¡´ ì½”ë“œ...

// ëŒ“ê¸€ ì¢‹ì•„ìš” í† ê¸€ í•¨ìˆ˜
const handleCommentLike = async (commentId) => {
  if (!currentUser) {
    alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤");
    navigate("/login");
    return;
  }
  try {
    const data = await likeComment(commentId);
    if (data.success) {
      setComments((prev) =>
        prev.map((c) =>
          c._id === commentId
            ? {
                ...c,
                likes: data.data.isLiked
                  ? [...c.likes, currentUser.id]
                  : c.likes.filter((id) => id !== currentUser.id),
              }
            : c
        )
      );
    }
  } catch (err) {
    alert(err.response?.data?.message || "ëŒ“ê¸€ ì¢‹ì•„ìš” ì²˜ë¦¬ ì‹¤íŒ¨");
  }
};

// ...ëŒ“ê¸€ ë Œë”ë§ ë¶€ë¶„...
{comments.map((comment) => {
  const isCommentLiked =
    currentUser && comment.likes?.includes(currentUser.id);
  return (
    <div key={comment._id}>
      {/* ...ê¸°ì¡´ ëŒ“ê¸€ ë‚´ìš©... */}
      <button
        onClick={() => handleCommentLike(comment._id)}
        className={isCommentLiked ? "bg-pink-100 text-pink-600" : "bg-gray-100 text-gray-500"}
      >
        {isCommentLiked ? "â¤ï¸" : "ğŸ¤"} {comment.likes.length}
      </button>
    </div>
  );
})}
```

#### ì„¤ëª… ë° ì£¼ì„
- ê° ëŒ“ê¸€ë§ˆë‹¤ ì¢‹ì•„ìš” ë²„íŠ¼ì´ ìƒê¸°ê³ , ëˆ„ë¥´ë©´ ì„œë²„ì— ìš”ì²­ í›„ ê°œìˆ˜/ìƒíƒœê°€ ì¦‰ì‹œ ë°˜ì˜ë¨
- ì´ë¯¸ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ê²½ìš° ë‹¤ì‹œ ëˆ„ë¥´ë©´ ì·¨ì†Œ(í† ê¸€)
- ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ë²„íŠ¼ í´ë¦­ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
- ì½”ë“œ ë‚´ ì£¼ì„ìœ¼ë¡œ ë™ì‘ ì›ë¦¬ì™€ ìœ„ì¹˜ë¥¼ ì„¤ëª…

---

## 3. API í•¨ìˆ˜

**ìœ„ì¹˜:** frontend/src/api.js

```js
// ëŒ“ê¸€ ì¢‹ì•„ìš” API í•¨ìˆ˜
export const likeComment = async (commentId) => {
  const token = localStorage.getItem("token");
  const response = await api.post(
    `/comments/${commentId}/like`,
    {},
    {
      headers: {
        Authorization: `Bearer ${token}`,
      },
    }
  );
  return response.data;
};
```

#### ì„¤ëª…
- ì„œë²„ì— ëŒ“ê¸€ ì¢‹ì•„ìš”/ì·¨ì†Œ ìš”ì²­ì„ ë³´ëƒ„
- ì‘ë‹µìœ¼ë¡œ ì¢‹ì•„ìš” ê°œìˆ˜ì™€ ìƒíƒœë¥¼ ë°›ì•„ì˜´

---

## 4. ì „ì²´ íë¦„ ìš”ì•½
1. ì‚¬ìš©ìê°€ ëŒ“ê¸€ì˜ ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­
2. í”„ë¡ íŠ¸ì—ì„œ likeComment API í˜¸ì¶œ â†’ ì„œë²„ì— ìš”ì²­
3. ì„œë²„ì—ì„œ í† ê¸€ ì²˜ë¦¬ í›„ ê²°ê³¼ ë°˜í™˜
4. í”„ë¡ íŠ¸ì—ì„œ ê°œìˆ˜/ìƒíƒœ ì¦‰ì‹œ ë°˜ì˜

---

> ì´ ë…¸íŠ¸ëŠ” 2025-12-25 ì‘ì—… ë‚´ì—­ì„ ì½”ë“œì™€ í•¨ê»˜ ì„¤ëª… ë° ì£¼ì„ìœ¼ë¡œ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.
